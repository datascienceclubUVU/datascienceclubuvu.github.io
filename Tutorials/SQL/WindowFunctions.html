<!DOCTYPE html>
<link rel="stylesheet" href="tutorials.css">
<title>SQL Tutorials: Window Functions</title>
<header>
<h1 style="text-align:center;">SQL Tutorials</h1>
    <div class="navbar">
        <a href="/Tutorials/SQLTutorials.html">Return to Home</a>
        <div class="dropdown" style="margin-left:80px;">
            <button class="dropbtn" style="margin-left:80px;">Learning Paths
            <i class="fa fa-caret-down"></i>
          </button>
          <div class="dropdown-content" style="min-width:150px;margin-left:5.2%;">
            <a href="DSBeginner.html">Data Science</a>
            <a href="DSIntermediate.html">Data Engineering</a>
            <a href="DSAdvanced.html">Software Engineering</a>
            <a href="Projects.html">Data Analytics</a>
          </div>
        </div>
        <div class="dropdown" style="margin-left:0px;">
            <button class="dropbtn" style="margin-left:60px;">Challenges
            <i class="fa fa-caret-down"></i>
          </button>
          <div class="dropdown-content" style="max-width:190px;margin-left:4%;">
            <a href="DEBeginner.html">Beginner</a>
            <a href="DEIntermediate.html">Intermediate</a>
            <a href="DEAdvanced.html">Advanced</a>
          </div>
        </div>
        <div class="dropdown">
          <button class="dropbtn">Projects
            <i class="fa fa-caret-down"></i>
          </button>
          <div class="dropdown-content" style="min-width:170px;margin-left:5.2%;">
            <a href="SEBeginner.html">Beginner</a>
            <a href="SEIntermediate.html">Intermediate</a>
            <a href="SEAdvanced.html">Advanced</a>
          </div>
        </div>
        <div class="dropdown" style="margin-left:0px;">
            <button class="dropbtn" style="margin-left:60px;">Related Topics
            <i class="fa fa-caret-down"></i>
          </button>
          <div class="dropdown-content" style="min-width:155px;margin-left:4.5%;">
            <a href="DABeginner.html">Python</a>
            <a href="DAIntermediate.html">NoSQL Databases</a>
            <a href="DAAdvanced.html">Tableau</a>
            <a href="Projects.html">Pandas</a>
          </div>
        </div>
      </div>
  </header>
  <div class="wrapperTutorials" style="width:1200px;">
    <section>
      <h2><u>ADVANCED SQL: WINDOW FUNCTIONS</u></h2><br><br>
      <h3 style="margin-left:99px;"><b><u>Introduction</u></b></h3>
      <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
        Welcome to the first ADVANCED tutorial in this learning series! This section will primarily focus on working with large datasets. One of the most common methods to analyze large amounts of data is to <b><i>partition</i></b>, or separate, the data into individual groups. This can be done using various <b>Window Functions.</b> A <b><i>Window Function</i></b> splits the data into individual groups based on a specified boundary (e.g., id, name, date). These are widely used for creating running totals, grouping data without changing the level of detail, and making it easier to identify potential duplicates. There are tens of window function available, so we'll just be focusing on the following categories:
        <ul style="margin-left:110px;">
            <li style="line-height:25px;">Ranking Functions</li>
            <li style="line-height:25px;">Aggregate Functions</li>
            <li style="line-height:25px;">Comparison Functions</li>
            <li style="line-height:25px;">Statistical Functions</li>
        </ul>
      </p>
    </div>

                                                       <!-- Rollup Extension -->
    <div class="wrapperTutorials" style="width:1200px;">
        <section>
      <h3 style="margin-left:99px;font-size:30px;"><b>RANKING FUNCTIONS</b></h3>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
            Within every organization, there is a need to measure attributes between various groups or departments. This allows organizations to create more detailed Key Performance Indicators (KPIs) and allow managers to measure the performance of their employees. Before we start learning about these functions, let's take a look at the general syntax below:</i></b><br>
            <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:18px;line-height:25px;">
                [window function name]() <b>OVER</b>(<b>PARTITION BY</b> [column name] ORDER BY [column name]) [new column name]
            </p>
        </p>
        <h4 style="margin-left:99px;font-size:25px;">ROW_NUMBER</h4>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
            The purpose of the ROW_NUMBER function is to specify the index number of each row within a partition. In the example below, we will illustrate how this function can be used in conjunction with CTEs:
        </p>
        <div class="grid-container">
            <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
            <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
        </div>
            <div class="grid-container">
        <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;" class="item1">
        &ensp;&ensp;&ensp;SELECT state, month, SUM(sales) runningTotal<br> 
        &ensp;&ensp;&ensp;FROM sales<br>
        &ensp;&ensp;&ensp;GROUP BY <b>ROLLUP</b> (state, month) <br>
        &ensp;&ensp;&ensp;ORDER BY state, CASE month<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          WHEN 'January' THEN 1<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          WHEN 'February' THEN 2<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          WHEN 'March' THEN 3<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          ELSE 4<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          END
                                        </p>
        
        <img style="margin-bottom:20px;" src="Images/rollupex.jpg" class="item2">
    </div>
    </section>
    </div>
                                                        <!-- Cube Extension -->
    <div class="wrapperTutorials" style="width:1200px;">
        <section>
        <h3 style="margin-left:99px;font-size:30px;"><b>AGGREGATE FUNCTIONS</b></h3>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
            The CUBE extension is a more detailed version of the ROLLUP extension. Rather than only showing only two levels of detail with the moving aggregates, the CUBE extension shows you every possible aggregation possible:
        <div class="grid-container">
            <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
            <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
        </div>
            <div class="grid-container">
        <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;" class="item1">
        &ensp;&ensp;&ensp;SELECT state, month, SUM(sales) runningTotal<br> 
        &ensp;&ensp;&ensp;FROM sales<br>
        &ensp;&ensp;&ensp;GROUP BY <b>CUBE</b> (state, month) <br>
        &ensp;&ensp;&ensp;ORDER BY state, CASE month<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          WHEN 'January' THEN 1<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          WHEN 'February' THEN 2<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          WHEN 'March' THEN 3<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          ELSE 4<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          END
                                        </p>
        
        <img style="margin-bottom:20px;" src="Images/cubeex.jpg" class="item2">
    </div>
        </section>
        </div>

                                                         <!-- Conclusion -->
    <div class="wrapperTutorials" style="width:1200px;">
    <section>
        <h3 style="margin-left:99px;font-size:30px;"><b>COMPARISON FUNCTIONS</b></h3>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
        One issue with the ROLLUP and CUBE extensions is the lack of identity associated with each level of detail. To help with this, the GROUPING_ID function was created:</p>
        <div class="grid-container">
            <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
            <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
        </div>
            <div class="grid-container">
        <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;" class="item1">
        &ensp;&ensp;&ensp;SELECT state, month, SUM(sales) runningTotal,<br>
        &ensp;&ensp;&ensp;<b>GROUPING_ID</b>(state, month) levelOfDetail<br>
        &ensp;&ensp;&ensp;FROM sales<br>
        &ensp;&ensp;&ensp;GROUP BY <b>CUBE</b> (state, month) <br>
        &ensp;&ensp;&ensp;ORDER BY state, CASE month<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          WHEN 'January' THEN 1<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          WHEN 'February' THEN 2<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          WHEN 'March' THEN 3<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          ELSE 4<br>
        &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                          END, levelOfDetail
                                        </p>
        
        <img style="margin-bottom:20px;" src="Images/groupingidex.jpg" class="item2">
    </div>
        </section>
        </div>

        <div class="wrapperTutorials" style="width:1200px;">
            <section>
                <h3 style="margin-left:99px;font-size:30px;"><b>STATISTICAL FUNCTIONS</b></h3>
                <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
                </p>
                <div class="grid-container">
                    <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
                    <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
                </div>
                    <div class="grid-container">
                <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;" class="item1">
                &ensp;&ensp;&ensp;SELECT state, month, SUM(sales) runningTotal<br>
                &ensp;&ensp;&ensp;FROM sales<br>
                &ensp;&ensp;&ensp;GROUP BY <b>GROUPING SETS</b> ((state, month), (state), (month)) <br>
                &ensp;&ensp;&ensp;ORDER BY state, CASE month<br>
                &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                                  WHEN 'January' THEN 1<br>
                &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                                  WHEN 'February' THEN 2<br>
                &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                                  WHEN 'March' THEN 3<br>
                &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                                  ELSE 4<br>
                &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;
                                                  END, levelOfDetail
                                                </p>
                
                <img style="margin-bottom:20px;" src="Images/groupingsetsex.jpg" class="item2">
            </div>
                </section>
                </div>

        <div class="wrapperTutorials" style="width:1200px;">
            <section>
                <h3 style="margin-left:99px;font-size:30px;"><b>CONCLUSION</b></h3>
                <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
                Data analysis in SQL can be very powerful, yet challenging to comprehend. As you may have noticed in the examples above, it can be difficult to see the difference between the different groups as far as which group in contributing the most or least. To help with this it's criticial to become proficient in basic Data Visualization techniques. Before continuing in this learning series, I would HIGHLY recomnmend checking how either the <a href="TableauTutorials.html">Tableau</a> or <a href="PowerBITutorials.html">Power BI</a> tutorials.</p>
                </section>
                </div>

                                                        <!-- Next Steps -->
    <div class="wrapperTutorials" style="width:1200px;">
        <section>
        <h3 style="margin-left:99px;font-size:22px;"><b><u>Next Steps</u></b></h3><p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">Querying techniques in SQL supercede everything. Now that we know how to perform some basic analytical techniques, let's look at how to create analytical tables::<br>
            <a href="GroupByExtensions.html" style="text-decoration:none;color:black;font-weight:bolder;">- Group By Extensions Tutorial  (Click here)</a>
        </p>
        </section>
        </div>
        </p>


    
</html>