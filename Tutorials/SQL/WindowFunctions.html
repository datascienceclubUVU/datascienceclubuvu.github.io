<!DOCTYPE html>
<link rel="stylesheet" href="tutorials.css">
<title>SQL Tutorials: Window Functions</title>
<header>
<h1 style="text-align:center;">SQL Tutorials</h1>
    <div class="navbar">
        <a href="/Tutorials/SQLTutorials.html">Return to Home</a>
        <div class="dropdown" style="margin-left:80px;">
            <button class="dropbtn" style="margin-left:80px;">Learning Paths
            <i class="fa fa-caret-down"></i>
          </button>
          <div class="dropdown-content" style="min-width:150px;margin-left:5.2%;">
            <a href="DSBeginner.html">Data Science</a>
            <a href="DSIntermediate.html">Data Engineering</a>
            <a href="DSAdvanced.html">Software Engineering</a>
            <a href="Projects.html">Data Analytics</a>
          </div>
        </div>
        <div class="dropdown" style="margin-left:0px;">
            <button class="dropbtn" style="margin-left:60px;">Challenges
            <i class="fa fa-caret-down"></i>
          </button>
          <div class="dropdown-content" style="max-width:190px;margin-left:4%;">
            <a href="DEBeginner.html">Beginner</a>
            <a href="DEIntermediate.html">Intermediate</a>
            <a href="DEAdvanced.html">Advanced</a>
          </div>
        </div>
        <div class="dropdown">
          <button class="dropbtn">Projects
            <i class="fa fa-caret-down"></i>
          </button>
          <div class="dropdown-content" style="min-width:170px;margin-left:5.2%;">
            <a href="SEBeginner.html">Beginner</a>
            <a href="SEIntermediate.html">Intermediate</a>
            <a href="SEAdvanced.html">Advanced</a>
          </div>
        </div>
        <div class="dropdown" style="margin-left:0px;">
            <button class="dropbtn" style="margin-left:60px;">Related Topics
            <i class="fa fa-caret-down"></i>
          </button>
          <div class="dropdown-content" style="min-width:155px;margin-left:4.5%;">
            <a href="DABeginner.html">Python</a>
            <a href="DAIntermediate.html">NoSQL Databases</a>
            <a href="DAAdvanced.html">Tableau</a>
            <a href="Projects.html">Pandas</a>
          </div>
        </div>
      </div>
  </header>
  <div class="wrapperTutorials" style="width:1200px;">
    <section>
      <h2><u>ADVANCED SQL: WINDOW FUNCTIONS</u></h2><br><br>
      <h3 style="margin-left:99px;"><b><u>Introduction</u></b></h3>
      <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
        Welcome to the first ADVANCED tutorial in this learning series! This section will primarily focus on working with large datasets. One of the most common methods to analyze large amounts of data is to <b><i>partition</i></b>, or separate, the data into individual groups. This can be done using various <b>Window Functions.</b> A <b><i>Window Function</i></b> splits the data into individual groups based on a specified boundary (e.g., id, name, date). These are widely used for creating running totals, grouping data without changing the level of detail, and making it easier to identify potential duplicates. There are tens of window function available, so we'll just be focusing on the following categories:
        <ul style="margin-left:110px;">
            <li style="line-height:25px;">Ranking Functions</li>
            <li style="line-height:25px;">Aggregate Functions</li>
            <li style="line-height:25px;">Comparison Functions</li>
            <li style="line-height:25px;">Statistical Functions</li>
        </ul>
      </p>
    </div>

                                                       <!-- Rollup Extension -->
    <div class="wrapperTutorials" style="width:1200px;">
        <section>
      <h3 style="margin-left:99px;font-size:30px;"><b>RANKING FUNCTIONS</b></h3>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
            Within every organization, there is a need to measure attributes between various groups or departments. This allows organizations to create more detailed Key Performance Indicators (KPIs) and allow managers to measure the performance of their employees. Before we start learning about these functions, let's take a look at the general syntax below:</i></b><br>
            <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:18px;line-height:25px;">
                [window function name]() <b>OVER</b>(<b>PARTITION BY</b> [column name] ORDER BY [column name]) [new column name]
            </p>
        </p>
        <h4 style="margin-left:99px;font-size:25px;">ROW_NUMBER</h4>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
            The purpose of the ROW_NUMBER function is to specify the index number of each row within a partition. In the example below, we will illustrate how this function can be used in conjunction with CTEs:
        </p>
        <div class="grid-container">
            <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
            <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
        </div>
            <div class="grid-container">
        <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:20px;color:black;font-weight:lighter;margin-left:0px;" class="item1">
        &ensp;&ensp;&ensp;-- Get all rows from table<br>
        &ensp;&ensp;&ensp;WITH all_tracks AS (<br> 
        &ensp;&ensp;&ensp;SELECT * FROM tracks),<br><br>
        &ensp;&ensp;&ensp;-- find the songs that occur more than once<br>
        &ensp;&ensp;&ensp;track_num AS ( <br>
        &ensp;&ensp;&ensp;SELECT track, artist<br>
        &ensp;&ensp;&ensp;FROM tracks<br>
        &ensp;&ensp;&ensp;GROUP BY track, artist<br>
        &ensp;&ensp;&ensp;HAVING COUNT(*) > 1),<br><br>
        &ensp;&ensp;&ensp;-- assign row numbers<br>
        &ensp;&ensp;&ensp;row_nums AS (<br>
        &ensp;&ensp;&ensp;SELECT <b>ROW_NUMBER()<br>
        &ensp;&ensp;&ensp;OVER(PARTITION BY track ORDER BY track, artist) row_num,</b><br>
        &ensp;&ensp;&ensp;track, artist<br>
        &ensp;&ensp;&ensp;FROM all_tracks<br><br>
        &ensp;&ensp;&ensp;-- join tables together<br>
        &ensp;&ensp;&ensp;SELECT row_nums.* FROM row_nums<br>
        &ensp;&ensp;&ensp;JOIN track_num ON row_nums.track = track_num.track<br>
        &ensp;&ensp;&ensp;ORDER BY row_nums.track, row_nums.artist, row_num;
        </p>
        <img style="margin-bottom:20px;" src="Images/rownumberex.jpg" class="item2">
    </div>
    <h4 style="margin-left:99px;font-size:25px;">RANK</h4>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
            As you might assume, this function is used to rank items within a specified group. This is commonly used to identify the best-selling products, most-productive employees, and highest gross profit. The one difference between this function and the ROW_NUMBER function is that the ORDER BY clause is REQUIRED.
        </p>
        <div class="grid-container">
            <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
            <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
        </div>
            <div class="grid-container">
        <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;margin-left:0px;" class="item1">
        &ensp;&ensp;&ensp;SELECT <b>RANK() OVER(PARTITION BY artist_name </b><br>
        &ensp;&ensp;&ensp;<b>ORDER BY track_count DESC)</b> popularity_rank, track_name<br> 
        &ensp;&ensp;&ensp;artist_name, track_count<br>
        &ensp;&ensp;&ensp;FROM song_popularity<br>
        &ensp;&ensp;&ensp;WHERE track_count > 3;
        </p>
        <img style="margin-bottom:20px;" src="Images/rankex.jpg" class="item2">
    </div>
    <h4 style="margin-left:99px;font-size:25px;">DENSE_RANK</h4>
    <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
        The main issue with the RANK function is that it skips ranks when there are duplicate values. This can make it difficult to interpret the results. To help with this, the DENSE_RANK function continues the rank rather than skips. This is usually used in place of the RANK function. In the example below, the highlighted rows show a great example of continuing the rank. If the RANK function was used the next row after the second highlighted row would be Ranked 4th.
    </p>
    <div class="grid-container">
        <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
        <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
    </div>
        <div class="grid-container">
    <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;margin-left:0px;" class="item1">
    &ensp;&ensp;&ensp;SELECT <b>DENSE_RANK() <br>
    &ensp;&ensp;&ensp;OVER(PARTITION BY artist_name </b><br>
    &ensp;&ensp;&ensp;<b>ORDER BY track_count DESC)</b> popularity_rank, track_name<br> 
    &ensp;&ensp;&ensp;artist_name, track_count<br>
    &ensp;&ensp;&ensp;FROM song_popularity<br>
    &ensp;&ensp;&ensp;WHERE track_count > 3;
    </p>
    <img style="margin-bottom:40px;" src="Images/denserankex.jpg" class="item2">
</div>
    </section>
    </div>

                                                        <!-- Cube Extension -->
    <div class="wrapperTutorials" style="width:1200px;">
        <section>
        <h3 style="margin-left:99px;font-size:30px;"><b>AGGREGATE FUNCTIONS</b></h3>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
            As mentioned in the Group By Extensions Tutorial, running totals and moving average allow businesses to see how pars contribute to a whole over time. This is the basic premise of the aggregate window functions. These allow you to see the cumulative amounts or moving averages in each group. This method is very similar to the CUBE or ROLLUP Group By Extensions, though these provide a more sophisticate view of your data and tned to be more accurate.
        <h4 style="margin-left:99px;font-size:25px;">SUM</h4>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
            As mentioned above, this function is a more sophisticated version of the ROLLUP Group By Extension. This window function allows you to see the cumulative sum of values within a group over a period of time or a series of events. In the example below, we will be creating a running total:
        </p>
        <div class="grid-container">
            <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
            <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
        </div>
            <div class="grid-container">
        <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;margin-left:0px;" class="item1">
        &ensp;&ensp;&ensp;SELECT track_name, artist_name, track_count,<br> 
        &ensp;&ensp;&ensp;<b>SUM(track_count) OVER(PARTITION BY artist_name)</b><br>
        &ensp;&ensp;&ensp;running_total<br>
        &ensp;&ensp;&ensp;FROM song_popularity<br>
        &ensp;&ensp;&ensp;WHERE track_count > 3<br>
        &ensp;&ensp;&ensp;ORDER BY artist_name, track_count
        </p>
        <img style="margin-bottom:20px;" src="Images/runningtotalex.jpg" class="item2">
    </div>
    <h4 style="margin-left:99px;font-size:25px;">AVG (AVERAGE)</h4>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
            When working with metrics that are based on continuous measures rather than discrete, it can be daunting to calculate the moving average. To help solve this, the average window function allows us to see how averages within a group changes over time.
        </p>
        <div class="grid-container">
            <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
            <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
        </div>
            <div class="grid-container">
        <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;margin-left:0px;" class="item1">
            &ensp;&ensp;&ensp;SELECT track_name, artist_name, track_count,<br> 
            &ensp;&ensp;&ensp;<b>AVG(track_count) OVER(PARTITION BY artist_name)</b><br>
            &ensp;&ensp;&ensp;moving_average<br>
            &ensp;&ensp;&ensp;FROM song_popularity<br>
            &ensp;&ensp;&ensp;WHERE track_count > 3<br>
            &ensp;&ensp;&ensp;ORDER BY artist_name, track_count
        </p>
        <img style="margin-bottom:40px;" src="Images/movingaverageex.jpg" class="item2">
    </div>
        </section>
        </div>

                                                         <!-- Conclusion -->
    <div class="wrapperTutorials" style="width:1200px;">
    <section>
        <h3 style="margin-left:99px;font-size:30px;"><b>COMPARISON FUNCTIONS</b></h3>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
        Have you ever wondered how stock brokers get rich fast? They take past data and compare it with current data. This is the basic premise of comparison window functions. It takes the current row value and compares it with either the first value, last value, previous value, or future value in the group.</p>
        <h4 style="margin-left:99px;font-size:25px;">LAG</h4>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
            As mentioned above, analysts compare past and current data to predict future outcomes. The LAG function allows you to do just that. It simply takes the value of the previous N rows and compares it with the current row:
        </p>
        <div class="grid-container">
            <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
            <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
        </div>
            <div class="grid-container">
        <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;margin-left:0px;" class="item1">
            &ensp;&ensp;&ensp;-- get previous values<br>
            &ensp;&ensp;&ensp;WITH lag_value AS (<br>
            &ensp;&ensp;&ensp;SELECT track_name, artist_name, track_count,<br> 
            &ensp;&ensp;&ensp;<b>LAG(track_count, 1) OVER(PARTITION BY artist_name<br>
            &ensp;&ensp;&ensp;ORDER BY track_count)</b><br>
            &ensp;&ensp;&ensp;previous_value<br>
            &ensp;&ensp;&ensp;FROM song_popularity<br>
            &ensp;&ensp;&ensp;WHERE track_count > 3)<br><br>
            &ensp;&ensp;&ensp;-- create column for comparison<br>
            &ensp;&ensp;&ensp;SELECT *, (previous_value - track_count) difference<br>
            &ensp;&ensp;&ensp;FROM lag_value<br>
            &ensp;&ensp;&ensp;ORDER BY artist_name, track_count
        </p>
        <img style="margin-bottom:40px;width:550px;" src="Images/lagvalueex.jpg" class="item2">
    </div>
    <h4 style="margin-left:99px;font-size:25px;">LEAD</h4>
    <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
        Predictive analysis is used by companies to predict future outcomes such as sales figures, employee turnover, and customer retention. The LEAD window function allows you to compare the current row with the value N rows below.
    </p>
    <div class="grid-container">
        <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
        <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
    </div>
        <div class="grid-container">
    <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;margin-left:0px;" class="item1">
        &ensp;&ensp;&ensp;-- get next values<br>
        &ensp;&ensp;&ensp;WITH lead_value AS (<br>
        &ensp;&ensp;&ensp;SELECT track_name, artist_name, track_count,<br> 
        &ensp;&ensp;&ensp;<b>LEAD(track_count, 1) OVER(PARTITION BY artist_name<br>
        &ensp;&ensp;&ensp;ORDER BY track_count)</b><br>
        &ensp;&ensp;&ensp;next_value<br>
        &ensp;&ensp;&ensp;FROM song_popularity<br>
        &ensp;&ensp;&ensp;WHERE track_count > 3)<br><br>
        &ensp;&ensp;&ensp;-- create column for comparison<br>
        &ensp;&ensp;&ensp;SELECT *, (next_value - track_count) difference<br>
        &ensp;&ensp;&ensp;FROM lead_value<br>
        &ensp;&ensp;&ensp;ORDER BY artist_name, track_count
    </p>
    <img style="margin-bottom:40px;width:550px;" src="Images/leadvalueex.jpg" class="item2">
</div>
    <h4 style="margin-left:99px;font-size:25px;">FIRST_VALUE</h4>
    <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
        The main limitation with the LAG and LEAD functions are that partitions are rarely the same length. To help solve this problem, SQL provides the FIRST_VALUE window function to compare the current row with the first row in the partition.
    </p>
    <div class="grid-container">
        <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
        <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
            </div>
            <div class="grid-container">
        <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;margin-left:0px;" class="item1">
            &ensp;&ensp;&ensp;-- get first values<br>
            &ensp;&ensp;&ensp;WITH first_values AS (<br>
            &ensp;&ensp;&ensp;SELECT track_name, artist_name, track_count,<br> 
            &ensp;&ensp;&ensp;<b>FIRST_VALUE(track_count) OVER(PARTITION BY<br>
            &ensp;&ensp;&ensp;artist_name ORDER BY track_count)</b><br>
            &ensp;&ensp;&ensp;first_value<br>
            &ensp;&ensp;&ensp;FROM song_popularity<br>
            &ensp;&ensp;&ensp;WHERE track_count > 3)<br><br>
            &ensp;&ensp;&ensp;-- create column for comparison<br>
            &ensp;&ensp;&ensp;SELECT *, (first_value - track_count) difference<br>
            &ensp;&ensp;&ensp;FROM first_values<br>
            &ensp;&ensp;&ensp;ORDER BY artist_name, track_count
        </p>
        <img style="margin-bottom:40px;width:530px;" src="Images/firstvalueex.jpg" class="item2">
        </div>
        <h4 style="margin-left:99px;font-size:25px;">LAST_VALUE</h4>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
            The LEAD version of the FIRST_VALUE window function is the LAST_VALUE window function. This allows you to comapre the current row with the last row in the partition. The only difference between the FIRST_VALUE and LAST_VALUE window functions is that the LAST_VALUE window function requires a range parameter. These allow you to include items within a portion of the partition or the entire partition. These parameters include the following:
            <ul style="margin-left:110px;">
                <li style="line-height:25px;"><b>RANGE UNBOUNDED PRECEDING:</b> This uses all rows between the top of the partition and the current row.</li>
                <li style="line-height:25px;"><b>RANGE N PRECEDING:</b> This uses the number of rows specified above the current row and the current row.</li>
                <li style="line-height:25px;"><b>RANGE CURRENT ROW:</b> This partitions every individual row.</li>
                <li style="line-height:25px;"><b>RANGE N FOLLOWING:</b> This specifies the range between the current row and n number of rows following.</li>
                <li style="line-height:25px;"><b>RANGE UNBOUNDED FOLLOWING:</b> This specifies the partition as the current row and the bottom of the partition.</li>
            </ul>
        </p>
        <div class="grid-container">
            <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
            <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
                </div>
                <div class="grid-container">
            <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;margin-left:0px;" class="item1">
                &ensp;&ensp;&ensp;-- get last values<br>
                &ensp;&ensp;&ensp;WITH last_values AS (<br>
                &ensp;&ensp;&ensp;SELECT track_name, artist_name, track_count,<br> 
                &ensp;&ensp;&ensp;<b>LAST_VALUE(track_count) OVER(PARTITION BY<br>
                &ensp;&ensp;&ensp;artist_name ORDER BY track_count<br>
                &ensp;&ensp;&ensp;RANGE BETWEEN UNBOUNDED PRECEDING AND<br>
                &ensp;&ensp;&ensp;UNBOUNDED FOLLOWING) last_value<br></b>
                &ensp;&ensp;&ensp;FROM song_popularity<br>
                &ensp;&ensp;&ensp;WHERE track_count > 3)<br><br>
                &ensp;&ensp;&ensp;-- create column for comparison<br>
                &ensp;&ensp;&ensp;SELECT *, (last_value - track_count) difference<br>
                &ensp;&ensp;&ensp;FROM last_values<br>
                &ensp;&ensp;&ensp;ORDER BY artist_name, track_count
            </p>
            <img style="margin-bottom:40px;width:530px;" src="Images/lastvalueex.jpg" class="item2">
            </div>
        </section>
        </div>

        <div class="wrapperTutorials" style="width:1200px;">
            <section>
                <h3 style="margin-left:99px;font-size:30px;"><b>STATISTICAL FUNCTIONS</b></h3>
                <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
                    Although SQL isn;t the best tool to use for conducting in-depth statistical analysis, it's still good to know what it can do. SQL provides a few statistical window functions for viewing the correlation and distribution of different values within a given partition.
                </p>
                <h4 style="margin-left:99px;font-size:25px;">NTILE</h4>
                <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
                    When conducting statistical analyses, generating sample data can be a great way to conduct experiments to gain accurate insights. To help with this process, the NTILE window function allows you to evenly split your data into different "buckets" or groups of data to compare each group against each other:
                </p>
                <div class="grid-container">
                    <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
                    <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
                </div>
                    <div class="grid-container">
                <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;margin-left:0px;" class="item1">
                    &ensp;&ensp;&ensp;SELECT track_name, artist_name, track_count,<br> 
                    &ensp;&ensp;&ensp;<b>NTILE(6) OVER(PARTITION BY artist_name<br>
                    &ensp;&ensp;&ensp;ORDER BY track_count) sample_group</b><br>
                    &ensp;&ensp;&ensp;FROM song_popularity<br>
                    &ensp;&ensp;&ensp;WHERE track_count > 6 AND<br>
                    &ensp;&ensp;&ensp;artist_name IN('Avicii', 'Calvin Harris',<br>
                    &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;'David Guetta', 'Don Diablo');
                </p>
                <img style="margin-bottom:40px;width:550px;" src="Images/ntileex.jpg" class="item2">
            </div>
            <h4 style="margin-left:99px;font-size:25px;">CUME_DIST</h4>
            <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
                If you are unfamiliar with statistics, the <b><i>cumulative distribution</i></b> is a measure that calculate the percentage of a whole accumulating values take up. Although this may not be the clearest example, the example below shows a good use case:
            </p>
            <div class="grid-container">
                <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
                <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
            </div>
                <div class="grid-container">
            <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;margin-left:0px;" class="item1">
                &ensp;&ensp;&ensp;SELECT track_name, artist_name, track_count,<br> 
                &ensp;&ensp;&ensp;<b>CUME_DIST() OVER(PARTITION BY artist_name<br>
                &ensp;&ensp;&ensp;ORDER BY track_count) cume_dist</b><br>
                &ensp;&ensp;&ensp;FROM song_popularity<br>
                &ensp;&ensp;&ensp;WHERE track_count > 6 AND<br>
                &ensp;&ensp;&ensp;artist_name IN('Avicii', 'Calvin Harris',<br>
                &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;'David Guetta', 'Don Diablo');
            </p>
            <img style="margin-bottom:40px;width:550px;" src="Images/cumedistex.jpg" class="item2">
        </div>
        <h4 style="margin-left:99px;font-size:25px;">PERCENT_RANK</h4>
        <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
            The PERCENT_RANK is very similar to the CUME_DIST function, though it works with percentiles rather than cumulative values. The value outputted with this function shows the value's position in the distribution of the partition.
        </p>
        <div class="grid-container">
            <h4 style="font-size:22px;color:black;" class="item1"><b>Example</b></h4>
            <h4 style="font-size:22px;color:black;" class="item2"><b>Output</b></h4>
        </div>
            <div class="grid-container">
        <p style="text-align:justify;padding-left:0px;padding-right:50px;font-size:16px;line-height:25px;color:black;font-weight:lighter;margin-left:0px;" class="item1">
            &ensp;&ensp;&ensp;SELECT track_name, artist_name, track_count,<br> 
            &ensp;&ensp;&ensp;<b>PERCENT_RANK() OVER(PARTITION BY artist_name<br>
            &ensp;&ensp;&ensp;ORDER BY track_count) percentile</b><br>
            &ensp;&ensp;&ensp;FROM song_popularity<br>
            &ensp;&ensp;&ensp;WHERE track_count > 6 AND<br>
            &ensp;&ensp;&ensp;artist_name IN('Avicii', 'Calvin Harris',<br>
            &ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;&ensp;'David Guetta', 'Don Diablo');
        </p>
        <img style="margin-bottom:40px;width:550px;" src="Images/percentileex.jpg" class="item2">
    </div>
                </section>
                </div>

        <div class="wrapperTutorials" style="width:1200px;">
            <section>
                <h3 style="margin-left:99px;font-size:30px;"><b>CONCLUSION</b></h3>
                <p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">
                Window functions are widely used for comparison and ranking techniques. It's critical to understand when and why the use of these types of functions to help you in your role as a Data Analyst. As mentioned before, SQL isn't the best tool for statistical analyses, for those I would HIGHLY recommend taking a look at the   <a href="/Tutorials/RTutorials.html">R</a> tutorials.</p>
                </section>
                </div>

                                                        <!-- Next Steps -->
    <div class="wrapperTutorials" style="width:1200px;">
        <section>
        <h3 style="margin-left:99px;font-size:22px;"><b><u>Next Steps</u></b></h3><p style="text-align:justify;padding-left:100px;padding-right:100px;font-size:16px;line-height:25px;">Window functions allow you to take an iterative approach to querying. Another key aspect of Data Analysis is the quality of your data. We'll learn more about this in the next tutorial:<br>
            <a href="DataCleaning.html" style="text-decoration:none;color:black;font-weight:bolder;">- Data Cleaning Tutorial  (Click here)</a>
        </p>
        </section>
        </div>
        </p>


    
</html>